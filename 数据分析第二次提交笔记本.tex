% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
  \usepackage{amssymb}
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Projet de VDD},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{Projet de VDD}
\author{}
\date{\vspace{-2.5em}}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(vcd)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: grid
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(car)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: carData
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(corrgram)}
\FunctionTok{library}\NormalTok{(Hmisc)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: lattice
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'lattice'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:corrgram':
## 
##     panel.fill
\end{verbatim}

\begin{verbatim}
## Loading required package: survival
\end{verbatim}

\begin{verbatim}
## Loading required package: Formula
\end{verbatim}

\begin{verbatim}
## Loading required package: ggplot2
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'Hmisc'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     format.pval, units
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(glmnet)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: Matrix
\end{verbatim}

\begin{verbatim}
## Loaded glmnet 4.1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base}\OtherTok{\textless{}{-}}\FunctionTok{read.csv}\NormalTok{(}\StringTok{"\textasciitilde{}/RR/Admission\_Predict.csv"}\NormalTok{)}
\FunctionTok{head}\NormalTok{(base)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Serial.No. GRE.Score TOEFL.Score University.Rating SOP LOR CGPA Research
## 1          1       337         118                 4 4.5 4.5 9.65        1
## 2          2       324         107                 4 4.0 4.5 8.87        1
## 3          3       316         104                 3 3.0 3.5 8.00        1
## 4          4       322         110                 3 3.5 2.5 8.67        1
## 5          5       314         103                 2 2.0 3.0 8.21        0
## 6          6       330         115                 5 4.5 3.0 9.34        1
##   Chance.of.Admit
## 1            0.92
## 2            0.76
## 3            0.72
## 4            0.80
## 5            0.65
## 6            0.90
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{states}\OtherTok{\textless{}{-}}\NormalTok{base[,}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\SpecialCharTok{:}\DecValTok{9}\NormalTok{)]}
\FunctionTok{head}\NormalTok{(states)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   GRE.Score TOEFL.Score University.Rating SOP LOR CGPA Research Chance.of.Admit
## 1       337         118                 4 4.5 4.5 9.65        1            0.92
## 2       324         107                 4 4.0 4.5 8.87        1            0.76
## 3       316         104                 3 3.0 3.5 8.00        1            0.72
## 4       322         110                 3 3.5 2.5 8.67        1            0.80
## 5       314         103                 2 2.0 3.0 8.21        0            0.65
## 6       330         115                 5 4.5 3.0 9.34        1            0.90
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{attach}\NormalTok{(states)}
\NormalTok{FillNA }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  x[}\FunctionTok{is.na}\NormalTok{(x )]}\OtherTok{\textless{}{-}} \FunctionTok{mode}\NormalTok{(x);}
\NormalTok{  x}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow =} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{))}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\DecValTok{9}\NormalTok{)\{}
  \FunctionTok{FillNA}\NormalTok{(}\FunctionTok{colnames}\NormalTok{(base)[i])}
  \FunctionTok{hist}\NormalTok{(base[,}\FunctionTok{c}\NormalTok{(i)],}\AttributeTok{xlab=}\FunctionTok{colnames}\NormalTok{(base)[i],}
       \AttributeTok{main=}\FunctionTok{paste}\NormalTok{(}\StringTok{"Histogram of"}\NormalTok{,}\FunctionTok{colnames}\NormalTok{(base)[i]))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{数据分析第二次提交笔记本_files/figure-latex/unnamed-chunk-5-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\FunctionTok{boxplot}\NormalTok{(Chance.of.Admit}\SpecialCharTok{\textasciitilde{}}\NormalTok{Research,}\AttributeTok{data=}\NormalTok{states)}
\FunctionTok{boxplot}\NormalTok{(Chance.of.Admit}\SpecialCharTok{\textasciitilde{}}\NormalTok{University.Rating,}\AttributeTok{data=}\NormalTok{states)}
\end{Highlighting}
\end{Shaded}

\includegraphics{数据分析第二次提交笔记本_files/figure-latex/unnamed-chunk-6-1.pdf}
以上我们可以得出录取率与所有参数之间的关系几乎都是线性变化的，没有指数变化的趋势，所以可以用多元回归的线性模型来模拟录取率与学生成绩的关系

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow =} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(GRE.Score,Chance.of.Admit,}\AttributeTok{pch=}\DecValTok{19}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\FunctionTok{lm}\NormalTok{(Chance.of.Admit}\SpecialCharTok{\textasciitilde{}}\NormalTok{GRE.Score),}\AttributeTok{col=}\StringTok{"red"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{1}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{lowess}\NormalTok{(GRE.Score,Chance.of.Admit),}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}

\FunctionTok{plot}\NormalTok{(TOEFL.Score,Chance.of.Admit,}\AttributeTok{pch=}\DecValTok{19}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\FunctionTok{lm}\NormalTok{(Chance.of.Admit}\SpecialCharTok{\textasciitilde{}}\NormalTok{TOEFL.Score),}\AttributeTok{col=}\StringTok{"red"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{1}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{lowess}\NormalTok{(TOEFL.Score,Chance.of.Admit),}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}

\FunctionTok{plot}\NormalTok{(University.Rating,Chance.of.Admit,}\AttributeTok{pch=}\DecValTok{19}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\FunctionTok{lm}\NormalTok{(Chance.of.Admit}\SpecialCharTok{\textasciitilde{}}\NormalTok{University.Rating),}\AttributeTok{col=}\StringTok{"red"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{1}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{lowess}\NormalTok{(University.Rating,Chance.of.Admit),}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}

\FunctionTok{plot}\NormalTok{(SOP,Chance.of.Admit,}\AttributeTok{pch=}\DecValTok{19}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\FunctionTok{lm}\NormalTok{(Chance.of.Admit}\SpecialCharTok{\textasciitilde{}}\NormalTok{SOP),}\AttributeTok{col=}\StringTok{"red"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{1}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{lowess}\NormalTok{(SOP,Chance.of.Admit),}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}

\FunctionTok{plot}\NormalTok{(LOR,Chance.of.Admit,}\AttributeTok{pch=}\DecValTok{19}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\FunctionTok{lm}\NormalTok{(Chance.of.Admit}\SpecialCharTok{\textasciitilde{}}\NormalTok{LOR),}\AttributeTok{col=}\StringTok{"red"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{1}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{lowess}\NormalTok{(LOR,Chance.of.Admit),}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}

\FunctionTok{plot}\NormalTok{(CGPA,Chance.of.Admit,}\AttributeTok{pch=}\DecValTok{19}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\FunctionTok{lm}\NormalTok{(Chance.of.Admit}\SpecialCharTok{\textasciitilde{}}\NormalTok{CGPA),}\AttributeTok{col=}\StringTok{"red"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{1}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{lowess}\NormalTok{(CGPA,Chance.of.Admit),}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{数据分析第二次提交笔记本_files/figure-latex/unnamed-chunk-7-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{options}\NormalTok{(}\AttributeTok{digits=}\DecValTok{2}\NormalTok{)}
\NormalTok{res}\OtherTok{\textless{}{-}}\FunctionTok{rcorr}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(states))}
\NormalTok{res}\SpecialCharTok{$}\NormalTok{r}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                   GRE.Score TOEFL.Score University.Rating  SOP  LOR CGPA
## GRE.Score              1.00        0.84              0.67 0.61 0.56 0.83
## TOEFL.Score            0.84        1.00              0.70 0.66 0.57 0.83
## University.Rating      0.67        0.70              1.00 0.73 0.66 0.75
## SOP                    0.61        0.66              0.73 1.00 0.73 0.72
## LOR                    0.56        0.57              0.66 0.73 1.00 0.67
## CGPA                   0.83        0.83              0.75 0.72 0.67 1.00
## Research               0.58        0.49              0.45 0.44 0.40 0.52
## Chance.of.Admit        0.80        0.79              0.71 0.68 0.67 0.87
##                   Research Chance.of.Admit
## GRE.Score             0.58            0.80
## TOEFL.Score           0.49            0.79
## University.Rating     0.45            0.71
## SOP                   0.44            0.68
## LOR                   0.40            0.67
## CGPA                  0.52            0.87
## Research              1.00            0.55
## Chance.of.Admit       0.55            1.00
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\FunctionTok{boxplot}\NormalTok{(Chance.of.Admit}\SpecialCharTok{\textasciitilde{}}\NormalTok{Research,}\AttributeTok{data=}\NormalTok{states)}

\FunctionTok{boxplot}\NormalTok{(Chance.of.Admit}\SpecialCharTok{\textasciitilde{}}\NormalTok{University.Rating,}\AttributeTok{data=}\NormalTok{states)}
\end{Highlighting}
\end{Shaded}

\includegraphics{数据分析第二次提交笔记本_files/figure-latex/unnamed-chunk-9-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{corrgram}\NormalTok{(states,}\AttributeTok{order=}\ConstantTok{TRUE}\NormalTok{,}\AttributeTok{lower.panel=}\NormalTok{panel.shade,}\AttributeTok{upper.panel=}\NormalTok{panel.pie,}\AttributeTok{text.panel=}\NormalTok{panel.txt)}
\end{Highlighting}
\end{Shaded}

\includegraphics{数据分析第二次提交笔记本_files/figure-latex/unnamed-chunk-10-1.pdf}
这里我们可以看出各个属性之间不存在完全的共线性，但一些属性之前还是存在很强的相关性，这可能会造成均方误差MSE过大，之后我们将使用岭回归和lasso回归尝试解决这个问题

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_lm }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(Chance.of.Admit}\SpecialCharTok{\textasciitilde{}}\NormalTok{., }\AttributeTok{data =}\NormalTok{states)}
\FunctionTok{summary}\NormalTok{(model\_lm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = Chance.of.Admit ~ ., data = states)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.2626 -0.0210  0.0100  0.0363  0.1593 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(>|t|)    
## (Intercept)       -1.259432   0.124731  -10.10  < 2e-16 ***
## GRE.Score          0.001737   0.000598    2.91   0.0039 ** 
## TOEFL.Score        0.002920   0.001090    2.68   0.0077 ** 
## University.Rating  0.005717   0.004770    1.20   0.2315    
## SOP               -0.003305   0.005562   -0.59   0.5527    
## LOR                0.022353   0.005541    4.03  6.6e-05 ***
## CGPA               0.118939   0.012219    9.73  < 2e-16 ***
## Research           0.024525   0.007960    3.08   0.0022 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.064 on 392 degrees of freedom
## Multiple R-squared:  0.803,  Adjusted R-squared:   0.8 
## F-statistic:  229 on 7 and 392 DF,  p-value: <2e-16
\end{verbatim}

以上是经过线性回归后模型各个参数的值，我们可以看到对于大部分参数来说t检验的p值都位于合理范围内，除了学生的大学等级和SOP绩点，也就是说模型对这两个属性变化时预测的准确程度不高

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{model.matrix}\NormalTok{(Chance.of.Admit}\SpecialCharTok{\textasciitilde{}}\NormalTok{., states)[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}
\NormalTok{y }\OtherTok{\textless{}{-}}\NormalTok{ Chance.of.Admit}
\NormalTok{lam }\OtherTok{\textless{}{-}} \DecValTok{10}\SpecialCharTok{\^{}}\FunctionTok{seq}\NormalTok{(}\DecValTok{10}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{, }\AttributeTok{length =} \DecValTok{100}\NormalTok{)}

\NormalTok{model\_rid }\OtherTok{\textless{}{-}} \FunctionTok{glmnet}\NormalTok{(x, y, }\AttributeTok{alpha =} \DecValTok{0}\NormalTok{, }\AttributeTok{lambda =}\NormalTok{ lam)}
\FunctionTok{coef.glmnet}\NormalTok{(model\_rid)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 8 x 100 sparse Matrix of class "dgCMatrix"
\end{verbatim}

\begin{verbatim}
##    [[ suppressing 100 column names 's0', 's1', 's2' ... ]]
\end{verbatim}

\begin{verbatim}
##                                                                          
## (Intercept)       7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01
## GRE.Score         1.4e-13 1.9e-13 2.5e-13 3.3e-13 4.3e-13 5.7e-13 7.6e-13
## TOEFL.Score       2.6e-13 3.5e-13 4.6e-13 6.1e-13 8.1e-13 1.1e-12 1.4e-12
## University.Rating 1.3e-12 1.7e-12 2.2e-12 2.9e-12 3.9e-12 5.1e-12 6.7e-12
## SOP               1.4e-12 1.8e-12 2.4e-12 3.1e-12 4.2e-12 5.5e-12 7.3e-12
## LOR               1.5e-12 2.0e-12 2.6e-12 3.5e-12 4.6e-12 6.1e-12 8.1e-12
## CGPA              3.0e-12 3.9e-12 5.2e-12 6.9e-12 9.1e-12 1.2e-11 1.6e-11
## Research          2.3e-12 3.0e-12 3.9e-12 5.2e-12 6.9e-12 9.1e-12 1.2e-11
##                                                                          
## (Intercept)       7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01
## GRE.Score         1.0e-12 1.3e-12 1.8e-12 2.3e-12 3.1e-12 4.0e-12 5.3e-12
## TOEFL.Score       1.9e-12 2.5e-12 3.3e-12 4.3e-12 5.7e-12 7.5e-12 1.0e-11
## University.Rating 8.9e-12 1.2e-11 1.6e-11 2.1e-11 2.7e-11 3.6e-11 4.8e-11
## SOP               9.6e-12 1.3e-11 1.7e-11 2.2e-11 2.9e-11 3.9e-11 5.1e-11
## LOR               1.1e-11 1.4e-11 1.9e-11 2.5e-11 3.3e-11 4.3e-11 5.7e-11
## CGPA              2.1e-11 2.8e-11 3.7e-11 4.8e-11 6.4e-11 8.5e-11 1.1e-10
## Research          1.6e-11 2.1e-11 2.8e-11 3.7e-11 4.9e-11 6.4e-11 8.5e-11
##                                                                          
## (Intercept)       7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01
## GRE.Score         7.1e-12 9.3e-12 1.2e-11 1.6e-11 2.2e-11 2.9e-11 3.8e-11
## TOEFL.Score       1.3e-11 1.7e-11 2.3e-11 3.0e-11 4.0e-11 5.3e-11 7.0e-11
## University.Rating 6.3e-11 8.3e-11 1.1e-10 1.5e-10 1.9e-10 2.5e-10 3.4e-10
## SOP               6.8e-11 9.0e-11 1.2e-10 1.6e-10 2.1e-10 2.7e-10 3.6e-10
## LOR               7.5e-11 1.0e-10 1.3e-10 1.7e-10 2.3e-10 3.0e-10 4.0e-10
## CGPA              1.5e-10 2.0e-10 2.6e-10 3.4e-10 4.5e-10 6.0e-10 7.9e-10
## Research          1.1e-10 1.5e-10 2.0e-10 2.6e-10 3.4e-10 4.5e-10 6.0e-10
##                                                                          
## (Intercept)       7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01
## GRE.Score         5.0e-11 6.6e-11 8.7e-11 1.2e-10 1.5e-10 2.0e-10 2.7e-10
## TOEFL.Score       9.3e-11 1.2e-10 1.6e-10 2.1e-10 2.8e-10 3.8e-10 5.0e-10
## University.Rating 4.4e-10 5.9e-10 7.8e-10 1.0e-09 1.4e-09 1.8e-09 2.4e-09
## SOP               4.8e-10 6.3e-10 8.4e-10 1.1e-09 1.5e-09 1.9e-09 2.6e-09
## LOR               5.3e-10 7.0e-10 9.3e-10 1.2e-09 1.6e-09 2.1e-09 2.8e-09
## CGPA              1.0e-09 1.4e-09 1.8e-09 2.4e-09 3.2e-09 4.2e-09 5.6e-09
## Research          7.9e-10 1.0e-09 1.4e-09 1.8e-09 2.4e-09 3.2e-09 4.2e-09
##                                                                          
## (Intercept)       7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01
## GRE.Score         3.5e-10 4.7e-10 6.2e-10 8.1e-10 1.1e-09 1.4e-09 1.9e-09
## TOEFL.Score       6.6e-10 8.7e-10 1.1e-09 1.5e-09 2.0e-09 2.6e-09 3.5e-09
## University.Rating 3.1e-09 4.1e-09 5.5e-09 7.2e-09 9.6e-09 1.3e-08 1.7e-08
## SOP               3.4e-09 4.5e-09 5.9e-09 7.8e-09 1.0e-08 1.4e-08 1.8e-08
## LOR               3.8e-09 5.0e-09 6.6e-09 8.7e-09 1.1e-08 1.5e-08 2.0e-08
## CGPA              7.4e-09 9.7e-09 1.3e-08 1.7e-08 2.3e-08 3.0e-08 3.9e-08
## Research          5.6e-09 7.4e-09 9.8e-09 1.3e-08 1.7e-08 2.3e-08 3.0e-08
##                                                                          
## (Intercept)       7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01
## GRE.Score         2.5e-09 3.3e-09 4.3e-09 5.7e-09 7.6e-09 1.0e-08 1.3e-08
## TOEFL.Score       4.6e-09 6.1e-09 8.1e-09 1.1e-08 1.4e-08 1.9e-08 2.5e-08
## University.Rating 2.2e-08 2.9e-08 3.9e-08 5.1e-08 6.7e-08 8.9e-08 1.2e-07
## SOP               2.4e-08 3.1e-08 4.2e-08 5.5e-08 7.3e-08 9.6e-08 1.3e-07
## LOR               2.6e-08 3.5e-08 4.6e-08 6.1e-08 8.1e-08 1.1e-07 1.4e-07
## CGPA              5.2e-08 6.9e-08 9.1e-08 1.2e-07 1.6e-07 2.1e-07 2.8e-07
## Research          3.9e-08 5.2e-08 6.9e-08 9.1e-08 1.2e-07 1.6e-07 2.1e-07
##                                                                          
## (Intercept)       7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01
## GRE.Score         1.8e-08 2.3e-08 3.1e-08 4.0e-08 5.3e-08 7.1e-08 9.3e-08
## TOEFL.Score       3.3e-08 4.3e-08 5.7e-08 7.5e-08 1.0e-07 1.3e-07 1.7e-07
## University.Rating 1.6e-07 2.1e-07 2.7e-07 3.6e-07 4.8e-07 6.3e-07 8.3e-07
## SOP               1.7e-07 2.2e-07 2.9e-07 3.9e-07 5.1e-07 6.8e-07 9.0e-07
## LOR               1.9e-07 2.5e-07 3.3e-07 4.3e-07 5.7e-07 7.5e-07 1.0e-06
## CGPA              3.7e-07 4.8e-07 6.4e-07 8.5e-07 1.1e-06 1.5e-06 2.0e-06
## Research          2.8e-07 3.7e-07 4.9e-07 6.4e-07 8.5e-07 1.1e-06 1.5e-06
##                                                                          
## (Intercept)       7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01
## GRE.Score         1.2e-07 1.6e-07 2.2e-07 2.9e-07 3.8e-07 5.0e-07 6.6e-07
## TOEFL.Score       2.3e-07 3.0e-07 4.0e-07 5.3e-07 7.0e-07 9.3e-07 1.2e-06
## University.Rating 1.1e-06 1.5e-06 1.9e-06 2.5e-06 3.4e-06 4.4e-06 5.9e-06
## SOP               1.2e-06 1.6e-06 2.1e-06 2.7e-06 3.6e-06 4.8e-06 6.3e-06
## LOR               1.3e-06 1.7e-06 2.3e-06 3.0e-06 4.0e-06 5.3e-06 7.0e-06
## CGPA              2.6e-06 3.4e-06 4.5e-06 6.0e-06 7.9e-06 1.0e-05 1.4e-05
## Research          2.0e-06 2.6e-06 3.4e-06 4.5e-06 6.0e-06 7.9e-06 1.0e-05
##                                                                          
## (Intercept)       7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01 7.2e-01
## GRE.Score         8.7e-07 1.2e-06 1.5e-06 2.0e-06 2.7e-06 3.5e-06 4.6e-06
## TOEFL.Score       1.6e-06 2.1e-06 2.8e-06 3.8e-06 5.0e-06 6.6e-06 8.7e-06
## University.Rating 7.7e-06 1.0e-05 1.4e-05 1.8e-05 2.4e-05 3.1e-05 4.1e-05
## SOP               8.4e-06 1.1e-05 1.5e-05 1.9e-05 2.6e-05 3.4e-05 4.5e-05
## LOR               9.3e-06 1.2e-05 1.6e-05 2.1e-05 2.8e-05 3.7e-05 4.9e-05
## CGPA              1.8e-05 2.4e-05 3.2e-05 4.2e-05 5.6e-05 7.4e-05 9.7e-05
## Research          1.4e-05 1.8e-05 2.4e-05 3.2e-05 4.2e-05 5.6e-05 7.4e-05
##                                                                          
## (Intercept)       7.2e-01 7.2e-01 7.2e-01 7.1e-01 7.1e-01 7.0e-01 7.0e-01
## GRE.Score         6.1e-06 8.1e-06 1.1e-05 1.4e-05 1.9e-05 2.5e-05 3.2e-05
## TOEFL.Score       1.1e-05 1.5e-05 2.0e-05 2.6e-05 3.5e-05 4.6e-05 6.0e-05
## University.Rating 5.5e-05 7.2e-05 9.5e-05 1.3e-04 1.7e-04 2.2e-04 2.9e-04
## SOP               5.9e-05 7.8e-05 1.0e-04 1.4e-04 1.8e-04 2.4e-04 3.1e-04
## LOR               6.5e-05 8.6e-05 1.1e-04 1.5e-04 2.0e-04 2.6e-04 3.4e-04
## CGPA              1.3e-04 1.7e-04 2.2e-04 3.0e-04 3.9e-04 5.1e-04 6.8e-04
## Research          9.7e-05 1.3e-04 1.7e-04 2.2e-04 3.0e-04 3.9e-04 5.1e-04
##                                                                          
## (Intercept)       6.9e-01 6.8e-01 6.7e-01 6.5e-01 0.62427 0.59452 0.55684
## GRE.Score         4.3e-05 5.6e-05 7.3e-05 9.6e-05 0.00012 0.00016 0.00021
## TOEFL.Score       7.9e-05 1.0e-04 1.4e-04 1.8e-04 0.00023 0.00030 0.00039
## University.Rating 3.8e-04 5.0e-04 6.5e-04 8.5e-04 0.00110 0.00143 0.00184
## SOP               4.1e-04 5.3e-04 7.0e-04 9.1e-04 0.00119 0.00154 0.00198
## LOR               4.5e-04 5.9e-04 7.8e-04 1.0e-03 0.00132 0.00172 0.00221
## CGPA              8.9e-04 1.2e-03 1.5e-03 2.0e-03 0.00262 0.00340 0.00439
## Research          6.7e-04 8.8e-04 1.2e-03 1.5e-03 0.00197 0.00256 0.00329
##                                                                           
## (Intercept)       0.50971 0.45166 0.38147 0.29848 0.20286 0.09587 -0.02012
## GRE.Score         0.00027 0.00034 0.00043 0.00053 0.00065 0.00079  0.00093
## TOEFL.Score       0.00050 0.00063 0.00079 0.00099 0.00121 0.00145  0.00172
## University.Rating 0.00235 0.00297 0.00372 0.00460 0.00558 0.00666  0.00778
## SOP               0.00252 0.00319 0.00398 0.00490 0.00593 0.00703  0.00817
## LOR               0.00283 0.00359 0.00450 0.00556 0.00678 0.00812  0.00955
## CGPA              0.00563 0.00717 0.00904 0.01127 0.01386 0.01681  0.02006
## Research          0.00421 0.00534 0.00670 0.00829 0.01010 0.01209  0.01420
##                                                                          
## (Intercept)       -0.1418 -0.2654 -0.3871 -0.5039 -0.6134 -0.7145 -0.8064
## GRE.Score          0.0011  0.0012  0.0014  0.0015  0.0017  0.0018  0.0019
## TOEFL.Score        0.0020  0.0023  0.0025  0.0028  0.0030  0.0032  0.0034
## University.Rating  0.0089  0.0099  0.0109  0.0116  0.0121  0.0124  0.0125
## SOP                0.0093  0.0102  0.0110  0.0116  0.0118  0.0117  0.0113
## LOR                0.0110  0.0124  0.0138  0.0150  0.0161  0.0170  0.0178
## CGPA               0.0236  0.0273  0.0311  0.0351  0.0392  0.0434  0.0478
## Research           0.0164  0.0184  0.0204  0.0221  0.0234  0.0245  0.0252
##                                                                          
## (Intercept)       -0.8886 -0.9614 -1.0245 -1.0781 -1.1224 -1.1578 -1.1854
## GRE.Score          0.0020  0.0021  0.0021  0.0021  0.0022  0.0021  0.0021
## TOEFL.Score        0.0035  0.0036  0.0037  0.0037  0.0036  0.0036  0.0035
## University.Rating  0.0124  0.0120  0.0115  0.0110  0.0103  0.0097  0.0090
## SOP                0.0106  0.0096  0.0085  0.0072  0.0058  0.0045  0.0032
## LOR                0.0185  0.0191  0.0197  0.0202  0.0206  0.0210  0.0214
## CGPA               0.0525  0.0574  0.0627  0.0682  0.0739  0.0797  0.0853
## Research           0.0257  0.0259  0.0259  0.0257  0.0256  0.0254  0.0252
##                                  
## (Intercept)       -1.2063 -1.2217
## GRE.Score          0.0021  0.0020
## TOEFL.Score        0.0035  0.0034
## University.Rating  0.0085  0.0079
## SOP                0.0021  0.0011
## LOR                0.0216  0.0219
## CGPA               0.0905  0.0954
## Research           0.0250  0.0248
\end{verbatim}

接下来我们使用岭回归模型，并且研究a取不同值时岭回归模型的准确程度，以上是a取100个不同值时模型的各个参数

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_rid}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:  glmnet(x = x, y = y, alpha = 0, lambda = lam) 
## 
##     Df %Dev   Lambda
## 1    7  0.0 1.00e+10
## 2    7  0.0 7.56e+09
## 3    7  0.0 5.72e+09
## 4    7  0.0 4.33e+09
## 5    7  0.0 3.27e+09
## 6    7  0.0 2.48e+09
## 7    7  0.0 1.87e+09
## 8    7  0.0 1.42e+09
## 9    7  0.0 1.07e+09
## 10   7  0.0 8.11e+08
## 11   7  0.0 6.14e+08
## 12   7  0.0 4.64e+08
## 13   7  0.0 3.51e+08
## 14   7  0.0 2.66e+08
## 15   7  0.0 2.01e+08
## 16   7  0.0 1.52e+08
## 17   7  0.0 1.15e+08
## 18   7  0.0 8.70e+07
## 19   7  0.0 6.58e+07
## 20   7  0.0 4.98e+07
## 21   7  0.0 3.76e+07
## 22   7  0.0 2.85e+07
## 23   7  0.0 2.15e+07
## 24   7  0.0 1.63e+07
## 25   7  0.0 1.23e+07
## 26   7  0.0 9.33e+06
## 27   7  0.0 7.05e+06
## 28   7  0.0 5.34e+06
## 29   7  0.0 4.04e+06
## 30   7  0.0 3.05e+06
## 31   7  0.0 2.31e+06
## 32   7  0.0 1.75e+06
## 33   7  0.0 1.32e+06
## 34   7  0.0 1.00e+06
## 35   7  0.0 7.56e+05
## 36   7  0.0 5.72e+05
## 37   7  0.0 4.33e+05
## 38   7  0.0 3.27e+05
## 39   7  0.0 2.48e+05
## 40   7  0.0 1.87e+05
## 41   7  0.0 1.42e+05
## 42   7  0.0 1.07e+05
## 43   7  0.0 8.11e+04
## 44   7  0.0 6.14e+04
## 45   7  0.0 4.64e+04
## 46   7  0.0 3.51e+04
## 47   7  0.0 2.66e+04
## 48   7  0.0 2.01e+04
## 49   7  0.0 1.52e+04
## 50   7  0.0 1.15e+04
## 51   7  0.0 8.70e+03
## 52   7  0.0 6.58e+03
## 53   7  0.0 4.98e+03
## 54   7  0.0 3.76e+03
## 55   7  0.0 2.85e+03
## 56   7  0.0 2.15e+03
## 57   7  0.1 1.63e+03
## 58   7  0.1 1.23e+03
## 59   7  0.1 9.33e+02
## 60   7  0.1 7.05e+02
## 61   7  0.2 5.34e+02
## 62   7  0.3 4.04e+02
## 63   7  0.3 3.05e+02
## 64   7  0.5 2.31e+02
## 65   7  0.6 1.75e+02
## 66   7  0.8 1.32e+02
## 67   7  1.1 1.00e+02
## 68   7  1.4 7.60e+01
## 69   7  1.8 5.70e+01
## 70   7  2.4 4.30e+01
## 71   7  3.2 3.30e+01
## 72   7  4.1 2.50e+01
## 73   7  5.4 1.90e+01
## 74   7  7.0 1.40e+01
## 75   7  9.1 1.10e+01
## 76   7 11.7 8.00e+00
## 77   7 14.9 6.00e+00
## 78   7 18.7 5.00e+00
## 79   7 23.3 4.00e+00
## 80   7 28.6 3.00e+00
## 81   7 34.5 2.00e+00
## 82   7 40.8 2.00e+00
## 83   7 47.2 1.00e+00
## 84   7 53.3 1.00e+00
## 85   7 59.0 1.00e+00
## 86   7 63.9 0.00e+00
## 87   7 68.0 0.00e+00
## 88   7 71.1 0.00e+00
## 89   7 73.5 0.00e+00
## 90   7 75.3 0.00e+00
## 91   7 76.6 0.00e+00
## 92   7 77.5 0.00e+00
## 93   7 78.2 0.00e+00
## 94   7 78.7 0.00e+00
## 95   7 79.1 0.00e+00
## 96   7 79.4 0.00e+00
## 97   7 79.7 0.00e+00
## 98   7 79.9 0.00e+00
## 99   7 80.0 0.00e+00
## 100  7 80.1 0.00e+00
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{16124706}\NormalTok{)}
\NormalTok{train }\OtherTok{=} \FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(x), }\FunctionTok{nrow}\NormalTok{(x)}\SpecialCharTok{*}\DecValTok{2}\SpecialCharTok{/}\DecValTok{3}\NormalTok{)}
\NormalTok{test }\OtherTok{=}\NormalTok{ (}\SpecialCharTok{{-}}\NormalTok{train)}
\NormalTok{ytest }\OtherTok{=}\NormalTok{ y[test]}
\NormalTok{Chance.of.Admitlm }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(Chance.of.Admit}\SpecialCharTok{\textasciitilde{}}\NormalTok{., }\AttributeTok{data =}\NormalTok{ states, }\AttributeTok{subset =}\NormalTok{ train)}
\NormalTok{ridge.mod }\OtherTok{\textless{}{-}} \FunctionTok{glmnet}\NormalTok{(x[train,], y[train], }\AttributeTok{alpha =} \DecValTok{0}\NormalTok{, }\AttributeTok{lambda =}\NormalTok{ lam)}
\NormalTok{cv.out }\OtherTok{\textless{}{-}} \FunctionTok{cv.glmnet}\NormalTok{(x[train,], y[train], }\AttributeTok{alpha =} \DecValTok{0}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(cv.out)}
\end{Highlighting}
\end{Shaded}

\includegraphics{数据分析第二次提交笔记本_files/figure-latex/unnamed-chunk-14-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{16124706}\NormalTok{)}
\NormalTok{train }\OtherTok{=} \FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(x), }\FunctionTok{nrow}\NormalTok{(x)}\SpecialCharTok{*}\DecValTok{2}\SpecialCharTok{/}\DecValTok{3}\NormalTok{)}
\NormalTok{test }\OtherTok{=}\NormalTok{ (}\SpecialCharTok{{-}}\NormalTok{train)}
\NormalTok{ytest }\OtherTok{=}\NormalTok{ y[test]}
\NormalTok{Chance.of.Admitlm }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(Chance.of.Admit}\SpecialCharTok{\textasciitilde{}}\NormalTok{., }\AttributeTok{data =}\NormalTok{ states, }\AttributeTok{subset =}\NormalTok{ train)}
\NormalTok{ridge.mod }\OtherTok{\textless{}{-}} \FunctionTok{glmnet}\NormalTok{(x[train,], y[train], }\AttributeTok{alpha =} \DecValTok{0}\NormalTok{, }\AttributeTok{lambda =}\NormalTok{ lam)}
\NormalTok{cv.out }\OtherTok{\textless{}{-}} \FunctionTok{cv.glmnet}\NormalTok{(x[train,], y[train], }\AttributeTok{alpha =} \DecValTok{0}\NormalTok{)}
\NormalTok{bestlam }\OtherTok{\textless{}{-}}\NormalTok{ cv.out}\SpecialCharTok{$}\NormalTok{lambda.min}
\NormalTok{ridge.pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(ridge.mod, }\AttributeTok{s =}\NormalTok{ bestlam, }\AttributeTok{newx =}\NormalTok{ x[test,])}
\NormalTok{s.pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(Chance.of.Admitlm, }\AttributeTok{newdata =}\NormalTok{ states[test,])}
\FunctionTok{mean}\NormalTok{((s.pred}\SpecialCharTok{{-}}\NormalTok{ytest)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.0042
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{((ridge.pred}\SpecialCharTok{{-}}\NormalTok{ytest)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.0043
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(s.pred}\SpecialCharTok{{-}}\NormalTok{ytest)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.0033
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(ridge.pred}\SpecialCharTok{{-}}\NormalTok{ytest)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.0042
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ridge.mod }\OtherTok{\textless{}{-}} \FunctionTok{glmnet}\NormalTok{(x[train,], y[train], }\AttributeTok{alpha =} \DecValTok{1}\NormalTok{, }\AttributeTok{lambda =}\NormalTok{ lam)}

\NormalTok{bestlam }\OtherTok{\textless{}{-}}\NormalTok{ ridge.mod}\SpecialCharTok{$}\NormalTok{lambda.min}
\end{Highlighting}
\end{Shaded}

\(\lamda\)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{out }\OtherTok{=} \FunctionTok{cv.glmnet}\NormalTok{(x[train,],y[train],}\AttributeTok{alpha =} \DecValTok{1}\NormalTok{)}
\NormalTok{bestlam }\OtherTok{\textless{}{-}}\NormalTok{ out}\SpecialCharTok{$}\NormalTok{lambda.min}
\FunctionTok{predict}\NormalTok{(ridge.mod, }\AttributeTok{type =} \StringTok{"coefficients"}\NormalTok{, }\AttributeTok{s =}\NormalTok{ bestlam)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{,]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       (Intercept)         GRE.Score       TOEFL.Score University.Rating 
##           -1.1060            0.0013            0.0037            0.0039 
##               SOP               LOR 
##            0.0000            0.0158
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_las }\OtherTok{\textless{}{-}} \FunctionTok{glmnet}\NormalTok{(x[train,], y[train], }\AttributeTok{alpha =} \DecValTok{1}\NormalTok{, }\AttributeTok{lambda =}\NormalTok{ lam)}
\NormalTok{pred\_las }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(model\_las, }\AttributeTok{s =}\NormalTok{ bestlam, }\AttributeTok{newx =}\NormalTok{ x[test,])}
\FunctionTok{mean}\NormalTok{((pred\_las}\SpecialCharTok{{-}}\NormalTok{ytest)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.0042
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(pred\_las}\SpecialCharTok{{-}}\NormalTok{ytest)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.0044
\end{verbatim}

以下是一些输入输出的例子

Add a new chunk by clicking the \emph{Insert Chunk} button on the
toolbar or by pressing \emph{Cmd+Option+I}.

When you save the notebook, an HTML file containing the code and output
will be saved alongside it (click the \emph{Preview} button or press
\emph{Cmd+Shift+K} to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the
editor. Consequently, unlike \emph{Knit}, \emph{Preview} does not run
any R code chunks. Instead, the output of the chunk when it was last run
in the editor is displayed.

\end{document}
